\ProvidesPackage{beamerthemeHUST}
% ==============================
% Provide package options
% ==============================
\SetupKeyvalOptions{
  family=template,
  prefix=template@
}
\DeclareStringOption[01]{background}
\DeclareStringOption[Red]{theme}
\DeclareStringOption[169]{aspectratio}
\ProcessKeyvalOptions*

\useinnertheme[shadow=true]{rounded}
% \useoutertheme{infolines}
% \usecolortheme{beaver}

\ifdefstring{\template@background}{logo}{
  \def\slidebackground{assets/logo/01.pdf}
  \newif\ifhustbyheight
  \hustbyheighttrue    % hoặc \hustbyheightfalse để neo theo width
}{
  \ifdefstring{\template@background}{logowithtext}{
    \def\slidebackground{assets/logo/02.pdf}
    \newif\ifhustbyheight
    \hustbyheighttrue    % hoặc \hustbyheightfalse để neo theo width
  }{
    \ifdefstring{\template@background}{hustwithtext}{
      \def\slidebackground{assets/logo/12.pdf}
      \newif\ifhustbyheight
      \hustbyheightfalse    % hoặc \hustbyheightfalse để neo theo width
    }{
      \ifdefstring{\template@background}{hust}{
        \def\slidebackground{assets/logo/16.pdf}
        \newif\ifhustbyheight
        \hustbyheightfalse    % hoặc \hustbyheightfalse để neo theo width
      }
      {}
    }
  }
}


\definecolor{darkred}{rgb}{0.8,0,0}

\setbeamercolor{section in toc}{fg=black,bg=white}
\setbeamercolor{alerted text}{fg=darkred!80!gray}
\setbeamercolor*{palette primary}{fg=darkred!60!black,bg=gray!30!white}
\setbeamercolor*{palette secondary}{fg=darkred!70!black,bg=gray!15!white}
\setbeamercolor*{palette tertiary}{bg=darkred!80!black,fg=gray!10!white}
\setbeamercolor*{palette quaternary}{fg=darkred,bg=gray!5!white}

\setbeamercolor*{sidebar}{fg=darkred,bg=gray!15!white}

\setbeamercolor*{palette sidebar primary}{fg=darkred!10!black}
\setbeamercolor*{palette sidebar secondary}{fg=white}
\setbeamercolor*{palette sidebar tertiary}{fg=darkred!50!black}
\setbeamercolor*{palette sidebar quaternary}{fg=gray!10!white}

%\setbeamercolor*{titlelike}{parent=palette primary}
\setbeamercolor{titlelike}{parent=palette primary,fg=darkred}

% --- HUST brand colors ---
\definecolor{HUSTNavy}{RGB}{0,51,102}
\definecolor{HUSTRed}{RGB}{192,32,52}
\definecolor{HUSTBlack}{RGB}{0,0,0}

\setbeamercolor{frametitle}{bg=HUSTNavy,fg=white}
\setbeamercolor{frametitle right}{bg=gray!60!white}

\makeatletter
\setbeamertemplate{frametitle}{%
  \nointerlineskip%
  \begin{beamercolorbox}[
      wd=\paperwidth,
      ht=0.065\paperheight,      % <-- vertical height above baseline
      dp=0.030\paperheight,      % <-- vertical depth below baseline
      leftskip=0.020\paperwidth,  % <-- left padding
      rightskip=0.020\paperwidth  % <-- right padding (only used if you add stuff on the right)
    ]{frametitle}%
    \usebeamerfont{frametitle}%
    \strut\insertframetitle\strut%
  \end{beamercolorbox}%
}
\makeatother

\setbeamercolor*{separation line}{}
\setbeamercolor*{fine separation line}{}

% --- Bottom footer + top bars (TikZ background canvas) ---
\RequirePackage{tikz}
\usetikzlibrary{calc}

\setbeamertemplate{background canvas}{%
  \begin{tikzpicture}[remember picture,overlay]

    \fill[HUSTRed]
      ($(current page.north west)+(0,-0.110\paperheight)$) rectangle
      ($(current page.north east)+(0,-0.118\paperheight)$);

    % \coordinate (footerBase) at ($(current page.south west)+(0.017\paperwidth,0.017\paperheight)$);

    % \node[anchor=south west] (hustlogo) at (footerBase) {%
    %   % \includegraphics[height=0.069\paperheight][width=]{\slidebackground}% 01 02 12 16
    %   \ifhustbyheight
    %     \includegraphics[height=0.069\paperheight,keepaspectratio]{\slidebackground}%
    %   \else
    %     \includegraphics[width=0.12\paperwidth,keepaspectratio]{\slidebackground}%
    %   \fi
    % };

    % \fill[HUSTRed]
    %   ($(hustlogo.south east)+(+0.010\paperwidth,0.053\paperheight)$) rectangle
    %   ($(current page.south east)+(-0.025\paperwidth,0.067\paperheight)$);

    % \fill[HUSTRed]
    %   ($(current page.south west)+(0,0.069\paperheight)$) rectangle
    %   ($(current page.south east)+(0,0.067\paperheight)$);

% Dải đỏ (giữ nguyên)
\pgfmathsetmacro{\barYtop}{0.069}   % giá trị lớn hơn là đỉnh
\pgfmathsetmacro{\barYbot}{0.067}   % giá trị nhỏ hơn là đáy
\pgfmathsetmacro{\barYmid}{(\barYtop+\barYbot)/2}

\fill[HUSTRed]
  ($(current page.south west)+(0,\barYtop*\paperheight)$) rectangle
  ($(current page.south east)+(0,\barYbot*\paperheight)$);

% Logo: tâm-chiều-cao trùng trung tuyến dải, mép trái cách lề 0.017\paperwidth
\node[anchor=mid west, inner sep=0pt, outer sep=0pt] (hustlogo)
  at ($(current page.south west)+(0.017\paperwidth,\barYmid*\paperheight)$) {%
    \ifhustbyheight
      \includegraphics[height=0.069\paperheight,keepaspectratio]{\slidebackground}%
    \else
      \includegraphics[width=0.12\paperwidth,keepaspectratio]{\slidebackground}%
    \fi
};


  \end{tikzpicture}%
}



\setbeamerfont{block title}{size={}}
\setbeamercolor{titlelike}{parent=structure,bg=white}
